<ion-app>
  <ion-router-outlet></ion-router-outlet>
  <!-- ...existing code... -->

  <!-- FAB global (botón principal + lista de opciones) -->
  <ion-fab *ngIf="showFab" vertical="bottom" horizontal="end" slot="fixed" class="global-calc-fab">
    <!-- Botón principal: al clickearlo, el FAB se desplegará mostrando las opciones -->
    <ion-fab-button aria-label="Abrir opciones">
      <ion-icon name="chevron-up-outline"></ion-icon>
    </ion-fab-button>

    <!-- Lista de opciones que aparece al desplegar el FAB. Añadir más botones aquí si es necesario. -->
    <ion-fab-list side="top">
      <ion-fab-button class="calculator-btn" (click)="toggleCalculator()" aria-label="Abrir calculadora">
        <ion-icon name="calculator-outline"></ion-icon>
      </ion-fab-button>
      <!-- Ejemplo: botón adicional (descomentá/ajustá según tus necesidades)
      <ion-fab-button (click)="otraAccion()" aria-label="Otra acción">
      <ion-icon name="star"></ion-icon>syn
      </ion-fab-button>
      -->
    </ion-fab-list>
  </ion-fab>

  <div *ngIf="showCalculator" class="floating-calculator" role="dialog" aria-label="Calculadora">
    <div class="calc-header">
      <h3>Calculadora / Selector de Empresa</h3>
    </div>

    <ion-item>
      <ion-label>Empresa</ion-label>
      <ion-select [(ngModel)]="selectedCompanyId" (ionChange)="onCompanyChange($event)" interface="popover"
        placeholder="Seleccione">
        <ion-select-option *ngFor="let e of companies" [value]="e.id">{{ e.name }}</ion-select-option>
      </ion-select>
    </ion-item>

    <div class="company-info" *ngIf="selectedCompany">
      <small>Empresa seleccionada: <strong>{{ selectedCompany.name }}</strong></small>
    </div>

    <ion-grid>
      <ion-row>
        <ion-col size="12">
          <ion-item>
            <ion-label position="stacked">Base USD</ion-label>
            <ion-input type="number" [(ngModel)]="baseUsd" (ionChange)="recalcTotals()" placeholder="0.00"></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label>Calcular IVA 16%</ion-label>
            <ion-checkbox slot="start" [(ngModel)]="calcularIva" (ionChange)="recalcTotals()"></ion-checkbox>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label position="stacked">IVA 16% USD</ion-label>
            <ion-input type="number" [(ngModel)]="ivaUsd" [disabled]="calcularIva" (ionChange)="recalcTotals()"
              placeholder="0.00" readonly></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label position="stacked">Descuento USD</ion-label>
            <ion-input type="number" [(ngModel)]="descuentoUsd" (ionChange)="recalcTotals()" placeholder="0.00"
              readonly></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label position="stacked">Total IVA USD</ion-label>
            <ion-input type="text" [value]="totalIvaUsd | number:'1.2-2'" readonly></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label position="stacked">Total Tasa BCV</ion-label>
            <ion-input type="text" [value]="totalTasaBcv | number:'1.2-2'" readonly></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label position="stacked">Total Tasa Paralelo USD</ion-label>
            <ion-input type="text" [value]="totalTasaParaleloUsd | number:'1.2-2'" readonly></ion-input>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-grid>

    <div class="calc-actions">
      <ion-button size="small" color="medium" (click)="toggleCalculator()">Cerrar</ion-button>
    </div>
  </div>

</ion-app>